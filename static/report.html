<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Reports</title>
    <!--link href="layout.css" rel="stylesheet" type="text/css"-->
    <!--[if lte IE 8]><script language="javascript" type="text/javascript" src="../excanvas.min.js"></script><![endif]-->
    <script language="javascript" type="text/javascript" src="jquery.js"></script>

 </head>
<script type="text/javascript">
</script>

    <body>
    <h2>Reports</h2>

	<textarea id="myresultform" rows="20" cols="80">
My text
	</textarea>

	<p>
	<textarea id="myinputform" rows="3" cols="80">
Query...
	</textarea>

	<p>
	<span><input class="submit" type="button" value="Submit" onclick="submitTryit()"></span>

	<!-- now we need a button -->

    <p>Simple example.2 </p>

	<!-- assume we're authenticated as an administrator -->
	<!-- we want a text form to display the result -->
	<!-- ok, we want to try to load a json file -->


<script type="text/javascript">
$(function () {

	console.log( 'hithere' );

	$('#myinputform')[0].value =  "select id, t,msg from events where msg = 'error' order by id desc limit 10";

	$('#myresultform')[0].value = '';

});

	function submitTryit( x )
	{
		console.log( '--------------' );

		var query = $('#myinputform')[0].value ;
		console.log( query );

		// console.log(  document.getElementById("myinputform").value );
		//	var encoded_query = encodeURIComponent(query);

		// let javascript handle the encoding...
		// except we'll fix spaces


		// query = query.replace(/ /g, "%20");

		//console.log( 'query now ' + query );


		$.ajax({
			dataType: "text",
			url: "report.json",
			//data: { field1: encoded_query },
			//data: { field1: query },
			data: { field1: query },
			success: function ( value, textStatus, jqXHR ) {
				console.log( "success value is: " + value );
				$('#myresultform')[0].value = value;
			},
			error: function (jqXHR, textStatus, errorThrown ) {
				console.log( textStatus + errorThrown );
			}
		})
	}


</script>

 </body>
</html>
